<mat-progress-bar mode="query" color="accent" *ngIf="!contentsLoaded" style="position: fixed; top: 56px; z-index: 999;"></mat-progress-bar>

<div class="swiper-box-text" *ngIf="contentsLoaded">
    <swiper
        class="mySwiper swiper-container-h"
        [pagination]="true">

        <!-- Current Form, nested swipers -->
        <ng-template swiperSlide>
            <swiper
                class="mySwiper2 swiper-container-v"
                [direction]="'vertical'"
                [pagination]="true">
                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Deine aktuelle Form
                        </div>
                        <div class="mat-display-4">
                            {{userStatsView.currentForm}}
                        </div>
                    </div>
                </ng-template>
                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Formstärkster ({{bestForm.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{bestForm.statValue}}
                        </div>
                    </div>
                </ng-template>
                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Formschwächster ({{worstForm.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{worstForm.statValue}}
                        </div>
                    </div>
                </ng-template>
            </swiper>
        </ng-template>

        <!-- Mean points, nested swipers -->
        <ng-template swiperSlide>
            <swiper
                class="mySwiper2 swiper-container-v"
                [direction]="'vertical'"
                [pagination]="true">

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Punkteschnitt
                        </div>
                        <div class="mat-display-4">
                            {{userStatsView.meanPoints}}
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Bester Schnitt ({{bestMean.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{bestMean.statValue}}
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Schwächster Schnitt ({{worstMean.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{worstMean.statValue}}
                        </div>
                    </div>
                </ng-template>

            </swiper>
        </ng-template>

        <ng-template swiperSlide>
            <swiper
                class="mySwiper2 swiper-container-v"
                [direction]="'vertical'"
                [pagination]="true">

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Fluktuation pro Spieltag
                        </div>
                        <div class="mat-display-4">
                            {{userStatsView.standardDeviation}}
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Geringste Fluktuation ({{lowestDeviation.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{lowestDeviation.statValue}}
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Höchste Fluktuation ({{highestDeviation.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{highestDeviation.statValue}}
                        </div>
                    </div>
                </ng-template>

            </swiper>
        </ng-template>

        <ng-template swiperSlide>
            <swiper
                class="mySwiper2 swiper-container-v"
                [direction]="'vertical'"
                [pagination]="true">

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Relative Fluktuation
                        </div>
                        <div class="mat-display-4">
                            {{userStatsView.standardDevRel}} %
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Am stabilsten ({{lowestDeviationRel.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{lowestDeviationRel.statValue}} %
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Am instabilsten ({{highestDeviationRel.userName}})
                        </div>
                        <div class="mat-display-4">
                            {{highestDeviationRel.statValue}} %
                        </div>
                    </div>
                </ng-template>

            </swiper>
        </ng-template>

        <ng-template swiperSlide>
            <swiper
            class="mySwiper2 swiper-container-v"
            [direction]="'vertical'"
            [pagination]="true">
            
            <ng-template swiperSlide>
                <div class="number-container">
                    <div class="mat-caption">
                        Höchste Punktzahl
                    </div>
                    <div class="mat-display-4">
                        {{userStatsView.highestPoints}}
                    </div>
                </div>
            </ng-template>

            <ng-template swiperSlide>
                <div class="number-container">
                    <div class="mat-caption">
                        Bester Tageswert ({{bestHighestPoints.userName}})
                    </div>
                    <div class="mat-display-4">
                        {{bestHighestPoints.statValue}}
                    </div>
                </div>
            </ng-template>

            </swiper>
        </ng-template>

        <ng-template swiperSlide>
            <swiper
            class="mySwiper2 swiper-container-v"
            [direction]="'vertical'"
            [pagination]="true">

                <ng-template swiperSlide>
                    <div class="number-container">
                        <div class="mat-caption">
                            Dein häufigster Tipp
                        </div>
                        <div class="mat-display-4">
                            {{userStatsView.mostFrequentBet}}
                        </div>
                    </div>
                </ng-template>

                <ng-template swiperSlide *ngFor="let mostFrequentBet of allMostFrequentBets">
                    <div class="number-container">
                        <div class="mat-caption">
                            {{mostFrequentBet.userName}}{{mostFrequentBet.userName[mostFrequentBet.userName.length-1] !== "s" ? "s" : "'"}} häufigster Tipp
                        </div>
                        <div class="mat-display-4">
                            {{mostFrequentBet.statValue}}
                        </div>
                    </div>
                </ng-template>

            </swiper>
        </ng-template>
    </swiper>
</div>

<div class="swiper-box-diagram" *ngIf="contentsLoaded">
    <swiper
        [pagination]="true">

        <ng-template swiperSlide>
            <div class="diagram-container">
                <div class="mat-caption">
                    Deine häufigsten Tipps
                </div>
                <div class="pie-container">
                    <ngx-charts-pie-chart
                        [results]="frequentBets"
                        [legend]="false"
                        [labels]="true"
                        [tooltipDisabled]="true"
                        [scheme]="pieColorScheme">
                    </ngx-charts-pie-chart>
                </div>
            </div>  
        </ng-template>

        <ng-template swiperSlide>
            <div class="diagram-container">
                <div class="mat-caption">
                    Box-Plot
                    <br><br>
                </div>
                <div style="font-size: smaller;">
                    <mat-form-field appearance="outline">
                        <mat-label>Vergleichen:</mat-label>
                        <mat-select class="compare-select" [formControl]="boxPlotUsers" (selectionChange)="setBoxPlotDiagram($event)" multiple >
                          <mat-option *ngFor="let user of otherUsers" [value]="user.id" [disabled]="!boxPlotUsers.value.includes(user.id) && boxPlotUsers.value.length >= 2">{{user.displayName}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="boxplot-container">           
                        <ngx-charts-box-chart
                            [results]="boxPlotData"
                            [roundDomains]="true"
                            [tooltipDisabled]="true"
                            [strokeWidth]="2">
                        </ngx-charts-box-chart>
                </div>
            </div>  
        </ng-template>

        <ng-template swiperSlide>
            <div class="diagram-container">
                <div class="mat-caption" style="margin-bottom: 15px;">
                    Plazierungsverlauf
                </div>
                <div style="font-size: smaller;">
                    <mat-form-field appearance="outline">
                        <mat-label>Vergleichen:</mat-label>
                        <mat-select class="compare-select" [formControl]="positionHistoryUsers" (selectionChange)="setPositionDiagram($event)" multiple >
                          <mat-option *ngFor="let user of otherUsers" [value]="user.id" [disabled]="!positionHistoryUsers.value.includes(user.id) && positionHistoryUsers.value.length >= 2">{{user.displayName}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="linechart-container">
                    <ngx-charts-line-chart
                        [xAxis]="true"
                        [yAxis]="true"
                        [results]="positionHistoryData"
                        [showGridLines]="true"
                        [yScaleMin]="positionHistoryOptions.yMin"
                        [yScaleMax]="positionHistoryOptions.yMax"
                        [yAxisTickFormatting]="positionHistoryOptions.formattingFcn"
                        [yAxisTicks]="positionHistoryOptions.ticks"
                        [roundDomains]="true"
                        [tooltipDisabled]="true"
                        [legend]="positionHistoryUsers.value.length > 0"
                        [legendPosition]="below"
                        [legendTitle]="''"
                        [scheme]="lineColorScheme">
                    </ngx-charts-line-chart>
                </div>
            </div>  
        </ng-template>

        <ng-template swiperSlide>
            <div class="diagram-container">
                <div class="mat-caption" style="margin-bottom: 15px;">
                    Formverlauf
                </div>
                <div style="font-size: smaller;">
                    <mat-form-field appearance="outline">
                        <mat-label>Vergleichen:</mat-label>
                        <mat-select class="compare-select" [formControl]="formHistoryUsers" (selectionChange)="setFormDiagram($event)" multiple >
                          <mat-option *ngFor="let user of otherUsers" [value]="user.id" [disabled]="!formHistoryUsers.value.includes(user.id) && formHistoryUsers.value.length >= 2">{{user.displayName}}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="linechart-container">
                    <ngx-charts-line-chart
                        [xAxis]="true"
                        [yAxis]="true"
                        [results]="formHistoryData"
                        [showGridLines]="true"
                        [yScaleMin]="formHistoryOptions.yMin"
                        [yScaleMax]="formHistoryOptions.yMax"
                        [yAxisTicks]="formHistoryOptions.ticks"
                        [yAxisTickFormatting]="formHistoryOptions.formattingFcn"
                        [tooltipDisabled]="true"
                        [legend]="formHistoryUsers.value.length > 0"
                        [legendPosition]="below"
                        [legendTitle]="''"
                        [scheme]="lineColorScheme">
                    </ngx-charts-line-chart>
                </div>
            </div>  
        </ng-template>
    </swiper>

</div>